using System.Collections.Generic;
using System.Threading.Tasks;
using AutoWebPentester.API.Data.ResourcesRepository;
using AutoWebPentester.API.DTOs;
using AutoWebPentester.API.Model;

namespace AutoWebPentester.API.Data.PentestRepository
{
    public interface IPentestRepository
    {
        IEnumerable<PentestSketch> GetMostActualPentests(int userId);

        Task<IEnumerable<TagKind>> GetTagKinds();

        Task<IEnumerable<Tag>> GetTags(int tagKindId);
        Task<IEnumerable<PentestSketch>> GetPentestsByTag(int tagKindId);
        Task<PentestSketch> getPentestSketch(int pentestSketch);
      
        Task<PentestSketchDetailsDto> GetPentestSketchDetailsDto(int pentestSketch, int websiteId,IResourceRepository repo,int userId);
        Task<WebSite> GetWebsite(string url);
        Task<WebSite> GetWebsite(int websiteId);
        Task<IEnumerable<PentestSketch>> GetPentestsProvidedResource(int resourceId);
        Task<int> GetNumberOfPentestsWithTag(int id);
        Task<List<RequirementDto>> GetPentestResources(int pentestId, int websiteId);
        Task<List<Pentest>> GetPentestHistory(int websiteId);
        Task<Pentest> AddPentest(Pentest pentest);
        Task<Pentest> GetPentest(int pentestId);
        Task<int> GetNumberOfPentests(int websiteId);
        Task<List<Pentest>> GetPentestHistory(int websiteId, int userId);
        Task<int> GetNumberOfPentests(int websiteId, int id);
    }
}